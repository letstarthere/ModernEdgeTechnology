<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Join Our Referral Program | Modern Edge Technologies</title>
    <link rel="icon" href="../images/Black_logo.png">
    <link rel="preload" as="font" href="https://fonts.googleapis.com/css2?family=Manrope:wght@200;300;400;500;600;700;800&display=swap" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@200;300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/styles.css">
</head>
<body>
    <div id="cursor" class="custom-cursor"></div>

    <header class="header">
        <a href="/" class="logo">MODERN EDGE TECHNOLOGIES<span>.</span></a>
        <nav class="nav">
            <a href="/#services" class="nav-link">
                <div class="rolling-text">
                    <span>Services</span>
                    <span>Services</span>
                </div>
            </a>
            <a href="/#projects" class="nav-link">
                <div class="rolling-text">
                    <span>Projects</span>
                    <span>Projects</span>
                </div>
            </a>
            <a href="/#about" class="nav-link">
                <div class="rolling-text">
                    <span>About</span>
                    <span>About</span>
                </div>
            </a>
            <a href="/contact" class="nav-link">
                <div class="rolling-text">
                    <span>Contact Us</span>
                    <span>Contact Us</span>
                </div>
            </a>
            <a href="/referral" class="nav-link">
                <div class="rolling-text">
                    <span>Referral</span>
                    <span>Referral</span>
                </div>
            </a>
        </nav>
        <button class="mobile-menu" aria-label="Toggle mobile menu">
            <div class="hamburger">
                <div></div>
                <div></div>
            </div>
            <div class="close-icon">
                <div></div>
                <div></div>
            </div>
        </button>
    </header>

    <div class="mobile-menu-overlay">
        <button class="mobile-close-btn" aria-label="Close mobile menu"></button>
        <nav class="mobile-nav">
            <a href="/#services" class="mobile-nav-link">Services</a>
            <a href="/#projects" class="mobile-nav-link">Projects</a>
            <a href="/#about" class="mobile-nav-link">About</a>
            <a href="/contact" class="mobile-nav-link">Contact Us</a>
            <a href="/referral" class="mobile-nav-link">Referral</a>
        </nav>
        <div class="mobile-menu-logo">
            <img src="../images/Black_logo.png" alt="Modern Edge Technologies Logo">
        </div>
    </div>

    <div class="contact-page">
        <section class="contact-hero" style="padding: 8rem 1.5rem 4rem;">
            <div style="display: grid; grid-template-columns: 1fr; gap: 3rem; align-items: center; max-width: 1200px; margin: 0 auto;">
                <div style="text-align: left;">
                    <p style="font-size: 2.5rem; font-weight: 700; color: var(--color-black); line-height: 1.3; margin-bottom: 1.5rem;">Earn up to <span id="counter">R0</span> every time someone you refer purchases a MET service.</p>
                    <p style="font-size: 1.25rem; font-weight: 400; color: var(--color-grey-dark); line-height: 1.6;">Help your friends grow their business. Get rewarded for it.</p>
                </div>
                <div style="border-radius: 12px; overflow: hidden;">
                    <img src="../images/two_women_talking.jpg" alt="Referral Program" style="width: 100%; height: 400px; object-fit: cover; filter: grayscale(100%);">
                </div>
            </div>
        </section>

        <style>
            @media (min-width: 768px) {
                .contact-hero > div {
                    grid-template-columns: 1fr 1fr !important;
                }
                .contact-hero p:first-child {
                    font-size: 3rem !important;
                }
            }
        </style>

        <section class="section" data-theme="dark" style="padding: 6rem 1.5rem;">
            <div style="max-width: 1200px; margin: 0 auto;">
                <h2 style="font-size: 3rem; font-weight: 700; text-align: center; margin-bottom: 4rem;">HOW IT WORKS</h2>
                <div style="display: grid; grid-template-columns: 1fr; gap: 3rem;">
                    <div style="text-align: center;">
                        <h3 style="font-size: 2rem; font-weight: 600; margin-bottom: 1rem;">1. Sign up</h3>
                        <p style="font-size: 1.125rem; color: #ccc; max-width: 600px; margin: 0 auto;">Enter your name and email to receive your unique referral code and our terms and conditions.</p>
                    </div>
                    <div style="text-align: center;">
                        <h3 style="font-size: 2rem; font-weight: 600; margin-bottom: 1rem;">2. Share your code</h3>
                        <p style="font-size: 1.125rem; color: #ccc; max-width: 600px; margin: 0 auto;">Send your referral code to friends or family when they contact Modern Edge Technology.</p>
                    </div>
                    <div style="text-align: center;">
                        <h3 style="font-size: 2rem; font-weight: 600; margin-bottom: 1rem;">3. Get rewarded</h3>
                        <p style="font-size: 1.125rem; color: #ccc; max-width: 600px; margin: 0 auto;">Once their service is confirmed and paid, you earn up to R300 depending on their purchase value.</p>
                    </div>
                </div>
                <p style="font-size: 0.875rem; color: #999; text-align: center; margin-top: 4rem; max-width: 800px; margin-left: auto; margin-right: auto; line-height: 1.6;">
                    Referral must be a new client. Referral code must be mentioned when purchasing a service. Reward is paid after service delivery. Maximum reward is R300 per referral. No self-referrals.
                </p>
            </div>
        </section>

        <section class="contact-form-section">
            <form onsubmit="sendReferralEmail(event)" class="contact-form">
                <div class="form-item">
                    <h3>What's your full name?</h3>
                    <input type="text" id="full_name" name="full_name" required>
                </div>
                <div class="form-item">
                    <h3>What's your email?</h3>
                    <input type="email" id="email" name="email" required>
                </div>
                <input type="hidden" id="referral_code" name="referral_code">
                <div id="error-message" class="error" style="color: #e74c3c; margin-top: 1rem;"></div>
                <button type="submit" id="submit-btn">Get My Referral Code</button>
            </form>

            <div id="success-view" style="display: none; max-width: 600px; margin: 0 auto;">
                <div style="text-align: center; margin-bottom: 3rem;">
                    <h2 style="font-size: 2.5rem; font-weight: 700; margin-bottom: 1rem;">Your Referral Code</h2>
                    <p style="font-size: 1.125rem; color: #666;">Share this code with your friends and earn rewards</p>
                </div>
                
                <div style="border-top: 1px solid #000; padding: 2rem 0; margin-bottom: 2rem;">
                    <p style="font-size: 0.875rem; color: #666; margin-bottom: 0.5rem; text-transform: uppercase; letter-spacing: 0.1em;">Your Code</p>
                    <p id="referral-code" style="font-size: 2rem; font-weight: 700; letter-spacing: 0.2em; margin-bottom: 1.5rem;"></p>
                    <button id="copy-btn" style="background: #fff; color: #000; padding: 0.75rem 1.5rem; border: 1px solid #000; border-radius: 50px; font-size: 0.875rem; font-weight: 600; cursor: pointer; font-family: 'Manrope', sans-serif;">Copy Code</button>
                </div>
                
                <div style="border-top: 1px solid #000; padding: 2rem 0;">
                    <p style="font-size: 0.875rem; color: #666; margin-bottom: 1rem; text-transform: uppercase; letter-spacing: 0.1em;">Share Message</p>
                    <p id="share-text" style="background: #f5f5f5; padding: 1.5rem; font-size: 0.875rem; line-height: 1.6; white-space: pre-line; margin-bottom: 1.5rem; border-radius: 4px;"></p>
                    <button id="copy-message-btn" style="background: #fff; color: #000; padding: 0.75rem 1.5rem; border: 1px solid #000; border-radius: 50px; font-size: 0.875rem; font-weight: 600; cursor: pointer; font-family: 'Manrope', sans-serif;">Copy Message</button>
                </div>
            </div>
        </section>
    </div>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-brand">
                <h2 class="footer-title">MODERN EDGE TECHNOLOGIES.</h2>
            </div>
            <div class="footer-social">
                <a href="#" class="social-link">Instagram</a>
                <a href="#" class="social-link">Twitter</a>
                <a href="#" class="social-link">LinkedIn</a>
            </div>
        </div>
        <div class="footer-copyright">
            <p>&copy; 2026 Modern Edge Technologies. All rights reserved.</p>
        </div>
    </footer>

    <script>
        // Counter animation
        document.addEventListener('DOMContentLoaded', function() {
            const counter = document.getElementById('counter');
            if (counter) {
                let current = 0;
                const target = 300;
                const duration = 2000;
                const increment = target / (duration / 16);
                
                function animate() {
                    current += increment;
                    if (current < target) {
                        counter.textContent = 'R' + Math.floor(current);
                        requestAnimationFrame(animate);
                    } else {
                        counter.textContent = 'R' + target;
                    }
                }
                
                setTimeout(animate, 300);
            }
        });
        
        async function sendReferralEmail(e) {
            e.preventDefault();

            const email = document.getElementById("email").value;
            const full_name = document.getElementById("full_name").value;
            
            const firstName = full_name.split(' ')[0].toUpperCase();
            const randomDigits = Math.floor(100 + Math.random() * 900);
            const referral_code = `MET-${firstName}-${randomDigits}`;
            document.getElementById("referral_code").value = referral_code;

            const res = await fetch(
                "https://fgouqngfrxlfipufgxpy.supabase.co/functions/v1/send-referral-email",
                {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "apikey": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZnb3VxbmdmcnhsZmlwdWZneHB5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzAzNzY2MDksImV4cCI6MjA4NTk1MjYwOX0.apL9IqPZtGGyTx_J-HmevLZfnOmLasIlMwh_q4cV7Gc"
                    },
                    body: JSON.stringify({
                        email,
                        full_name,
                        referral_code
                    })
                }
            );

            const data = await res.json();
            console.log(data);
            
            document.querySelector('form').style.display = 'none';
            document.getElementById('success-view').style.display = 'block';
            document.getElementById('referral-code').textContent = referral_code;
            
            const shareMessage = `Check out Modern Edge Technologies (MET)\nhttps://modernedgetech.co.za\n\nUse my referral code: ${referral_code}`;
            document.getElementById('share-text').textContent = shareMessage;
            
            document.getElementById('copy-btn').addEventListener('click', () => {
                navigator.clipboard.writeText(referral_code).then(() => {
                    const btn = document.getElementById('copy-btn');
                    const originalText = btn.textContent;
                    btn.textContent = 'Copied!';
                    setTimeout(() => btn.textContent = originalText, 2000);
                });
            });
            
            document.getElementById('copy-message-btn').addEventListener('click', () => {
                navigator.clipboard.writeText(shareMessage).then(() => {
                    const btn = document.getElementById('copy-message-btn');
                    const originalText = btn.textContent;
                    btn.textContent = 'Copied!';
                    setTimeout(() => btn.textContent = originalText, 2000);
                });
            });
        }
        
        // Form focus functionality
        const formItems = document.querySelectorAll('.form-item');
        formItems.forEach(item => {
            const input = item.querySelector('input');
            const title = item.querySelector('h3');
            
            if (input && title) {
                title.addEventListener('click', () => {
                    item.classList.add('focused');
                    input.focus();
                });
                
                input.addEventListener('focus', () => {
                    item.classList.add('focused');
                });
                
                input.addEventListener('blur', () => {
                    if (!input.value) {
                        item.classList.remove('focused');
                    }
                });
            }
        });
    </script>
    <script src="../js/main.js"></script>
</body>
</html>
